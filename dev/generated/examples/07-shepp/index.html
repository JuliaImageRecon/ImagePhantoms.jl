<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Shepp-Logan Phantoms · ImagePhantoms.jl</title><meta name="title" content="Shepp-Logan Phantoms · ImagePhantoms.jl"/><meta property="og:title" content="Shepp-Logan Phantoms · ImagePhantoms.jl"/><meta property="twitter:title" content="Shepp-Logan Phantoms · ImagePhantoms.jl"/><meta name="description" content="Documentation for ImagePhantoms.jl."/><meta property="og:description" content="Documentation for ImagePhantoms.jl."/><meta property="twitter:description" content="Documentation for ImagePhantoms.jl."/><meta property="og:url" content="https://JuliaImageRecon.github.io/ImagePhantoms.jl/stable/generated/examples/07-shepp/"/><meta property="twitter:url" content="https://JuliaImageRecon.github.io/ImagePhantoms.jl/stable/generated/examples/07-shepp/"/><link rel="canonical" href="https://JuliaImageRecon.github.io/ImagePhantoms.jl/stable/generated/examples/07-shepp/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="ImagePhantoms.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ImagePhantoms.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../methods/">Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../01-overview/">ImagePhantoms overview</a></li><li><a class="tocitem" href="../02-ellipse/">Ellipse</a></li><li><a class="tocitem" href="../03-rect/">Rectangle</a></li><li><a class="tocitem" href="../04-gauss/">2D Gaussian</a></li><li><a class="tocitem" href="../05-triangle/">Triangle</a></li><li class="is-active"><a class="tocitem" href>Shepp-Logan Phantoms</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#CT-version"><span>CT version</span></a></li><li><a class="tocitem" href="#Over-sampling"><span>Over-sampling</span></a></li><li><a class="tocitem" href="#Units"><span>Units</span></a></li><li><a class="tocitem" href="#Toft-version"><span>Toft version</span></a></li><li><a class="tocitem" href="#Emission-tomography-version"><span>Emission tomography version</span></a></li><li><a class="tocitem" href="#BrainWeb-version"><span>BrainWeb version</span></a></li><li><a class="tocitem" href="#Disjoint-middle-ellipses"><span>Disjoint middle ellipses</span></a></li><li><a class="tocitem" href="#Comedy-version"><span>Comedy version</span></a></li></ul></li><li><a class="tocitem" href="../08-focus/">Focus Chart</a></li><li><a class="tocitem" href="../09-disk/">Random Disks</a></li><li><a class="tocitem" href="../10-mri-sense/">MRI SENSE</a></li><li><a class="tocitem" href="../30-3d/">3D geometry</a></li><li><a class="tocitem" href="../32-ellipsoid/">Ellipsoid</a></li><li><a class="tocitem" href="../33-cuboid/">Cuboid</a></li><li><a class="tocitem" href="../34-gauss3/">Gauss3</a></li><li><a class="tocitem" href="../35-cylinder/">Cylinder</a></li><li><a class="tocitem" href="../36-cone/">Cone</a></li><li><a class="tocitem" href="../37-shepp3/">3D Shepp-Logan Phantom</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Shepp-Logan Phantoms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Shepp-Logan Phantoms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaImageRecon/ImagePhantoms.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaImageRecon/ImagePhantoms.jl/blob/main/docs/lit/examples/07-shepp.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="07-shepp"><a class="docs-heading-anchor" href="#07-shepp">Shepp-Logan Phantoms</a><a id="07-shepp-1"></a><a class="docs-heading-anchor-permalink" href="#07-shepp" title="Permalink"></a></h1><p>This page illustrates the Shepp-Logan phantoms in the Julia package <a href="https://github.com/JuliaImageRecon/ImagePhantoms.jl"><code>ImagePhantoms</code></a>.</p><p>This page comes from a single Julia file: <a href="https://github.com/JuliaImageRecon/ImagePhantoms.jl/blob/main/docs/lit/examples/07-shepp.jl"><code>07-shepp.jl</code></a>.</p><p>You can access the source code for such Julia documentation using the &#39;Edit on GitHub&#39; link in the top right. You can view the corresponding notebook in <a href="https://nbviewer.org/">nbviewer</a> here: <a href="https://nbviewer.org/github/JuliaImageRecon/ImagePhantoms.jl/tree/gh-pages/dev/generated/examples/07-shepp.ipynb"><code>07-shepp.ipynb</code></a>, or open it in <a href="https://mybinder.org/">binder</a> here: <a href="https://mybinder.org/v2/gh/JuliaImageRecon/ImagePhantoms.jl/gh-pages?filepath=dev/generated/examples/07-shepp.ipynb"><code>07-shepp.ipynb</code></a>.</p><h3 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h3><p>Packages needed here.</p><pre><code class="language-julia hljs">using ImagePhantoms: shepp_logan, SouthPark
using ImagePhantoms: SheppLoganToft, SheppLoganEmis, SheppLoganBrainWeb
using ImagePhantoms: ellipse_parameters, ellipse, phantom
using MIRTjim: jim, prompt
using Unitful: g, cm</code></pre><p>The following line is helpful when running this file as a script; this way it will prompt user to hit a key after each figure is displayed.</p><pre><code class="language-julia hljs">isinteractive() ? jim(:prompt, true) : prompt(:draw);</code></pre><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>There are several variations of the Shepp-Logan phantom available.</p><h2 id="CT-version"><a class="docs-heading-anchor" href="#CT-version">CT version</a><a id="CT-version-1"></a><a class="docs-heading-anchor-permalink" href="#CT-version" title="Permalink"></a></h2><p>Original version from: Larry A Shepp, Benjamin F Logan, &quot;The Fourier reconstruction of a head section,&quot; IEEE Transactions on Nuclear Science, 21(3):21-42, June 1974. <a href="https://doi.org/10.1109/TNS.1974.6499235">doi</a></p><p>This (default) version has low soft tissue contrast, so it usually should be displayed with a narrow window the using <code>clim</code> option:</p><pre><code class="language-julia hljs">image1 = shepp_logan(256) # CT version by default
jim(image1, &quot;SheppLogan (original CT version)&quot;, clim=(0.95, 1.05))</code></pre><img src="2b47cc82.svg" alt="Example block output"/><h2 id="Over-sampling"><a class="docs-heading-anchor" href="#Over-sampling">Over-sampling</a><a id="Over-sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Over-sampling" title="Permalink"></a></h2><p>When generating ellipse phantoms, it is generally preferable to &quot;over-sample&quot; the ellipse values within each pixel to account for partial volume effect. A factor of 3 over-sampling (along both axes) typically suffices, so this factor is the default for the <code>shepp_logan</code> method. Here is how the phantom image looks without over-sampling:</p><pre><code class="language-julia hljs">image1o = shepp_logan(256; oversample=1)
jim(image1o, &quot;No over sampling&quot;, clim=(0.95,1.05))</code></pre><img src="8a9310d3.svg" alt="Example block output"/><p>Note that boundaries of the interior ellipses look smoother in the original version with the default 3× over-sampling. Most of the remaining examples use the recommended default over-sampling.</p><h2 id="Units"><a class="docs-heading-anchor" href="#Units">Units</a><a id="Units-1"></a><a class="docs-heading-anchor-permalink" href="#Units" title="Permalink"></a></h2><p>The original Shepp-Logan phantom in the paper as cited above did not give any units for the grayscale values, but the values were described as &quot;densities&quot; and indeed the values are reasonable for head CT scans if interpreted as having g/cm³ units. Here is a version with units.</p><pre><code class="language-julia hljs">image1u = image1 * g/cm^3
jim(image1u, &quot;SheppLogan with density units&quot;, clim=(0.95,1.05))</code></pre><img src="cf5c4385.svg" alt="Example block output"/><h2 id="Toft-version"><a class="docs-heading-anchor" href="#Toft-version">Toft version</a><a id="Toft-version-1"></a><a class="docs-heading-anchor-permalink" href="#Toft-version" title="Permalink"></a></h2><p>This version is from: Toft, Peter Aundal &amp; Sørensen, John Aasted &quot;The Radon transform-theory and implementation,&quot; Technical University of Denmark (DTU), 1996. Page 201. <a href="https://files.openpdfs.org/1ra51GP6gJO.pdf">pdf</a></p><pre><code class="language-julia hljs">image2 = shepp_logan(256, SheppLoganToft())
jim(image2, &quot;SheppLoganToft&quot;)</code></pre><img src="db4de9ab.svg" alt="Example block output"/><h2 id="Emission-tomography-version"><a class="docs-heading-anchor" href="#Emission-tomography-version">Emission tomography version</a><a id="Emission-tomography-version-1"></a><a class="docs-heading-anchor-permalink" href="#Emission-tomography-version" title="Permalink"></a></h2><p>This version has low intensity for the skull because typical PET/SPECT radiotracers do not accumulate in bone regions. It is probably also useful for MRI, because typical MRI scans have low signal from bone.</p><pre><code class="language-julia hljs">image3 = shepp_logan(256, SheppLoganEmis())
jim(image3, &quot;SheppLoganEmis&quot;)</code></pre><img src="fda074b3.svg" alt="Example block output"/><h2 id="BrainWeb-version"><a class="docs-heading-anchor" href="#BrainWeb-version">BrainWeb version</a><a id="BrainWeb-version-1"></a><a class="docs-heading-anchor-permalink" href="#BrainWeb-version" title="Permalink"></a></h2><p>This version was inspired by the <a href="https://brainweb.bic.mni.mcgill.ca">BrainWeb</a> phantoms that have integer indices for each of the different regions. It should not be used directly, but rather one should assign meaningful intensity values to each of the integer indices.</p><pre><code class="language-julia hljs">image4 = shepp_logan(256, SheppLoganBrainWeb())
jim(image4, &quot;SheppLoganBrainWeb&quot;)</code></pre><img src="556a8803.svg" alt="Example block output"/><p>For the BrainWeb version, there is no over-sampling by default, to preserve the integer indices.</p><h2 id="Disjoint-middle-ellipses"><a class="docs-heading-anchor" href="#Disjoint-middle-ellipses">Disjoint middle ellipses</a><a id="Disjoint-middle-ellipses-1"></a><a class="docs-heading-anchor-permalink" href="#Disjoint-middle-ellipses" title="Permalink"></a></h2><p>Sometimes it can be more convenient to have the middle ellipses be non-overlapping:</p><pre><code class="language-julia hljs">params = ellipse_parameters(SheppLoganBrainWeb(), disjoint=true)
params = [(p[1:5]..., i) for (i, p) in enumerate(params)]
ob = ellipse(params)
x = range(-0.4, 0.4, 206)
y = range(-0.5, 0.5, 256)
oversample = 3
image5 = phantom(x, y, ob, oversample)
jim(x, y, image5, &quot;Disjoint&quot;; aspect_ratio = 1)</code></pre><img src="30dde13b.svg" alt="Example block output"/><h2 id="Comedy-version"><a class="docs-heading-anchor" href="#Comedy-version">Comedy version</a><a id="Comedy-version-1"></a><a class="docs-heading-anchor-permalink" href="#Comedy-version" title="Permalink"></a></h2><pre><code class="language-julia hljs">image6 = shepp_logan(256, SouthPark(); fovs=(1,1))
jim(image6, &quot;SouthPark&quot;)</code></pre><img src="5939957d.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../05-triangle/">« Triangle</a><a class="docs-footer-nextpage" href="../08-focus/">Focus Chart »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 12 August 2025 04:48">Tuesday 12 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
